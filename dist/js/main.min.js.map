{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","scrollToSpeed","init","_this","this","$","window","resize","onResize","document","ready","length","Portraits","Player","Map","Paypal","Gallery","fitHeight","calcHeight","$fitElements","windowHeight","height","headerHeight","minHeight","css","min-height","fixWidows","each","string","html","replace","instances","options","pagination","loop","slidesPerView","loopedSlides","spaceBetween","paginationClickable","centeredSlides","onTap","swiper","slideNext","index","element","Swiper","styleForm","removeClass","styleBuy","$buy","$form","find","$select","attr","wrap","prepend","remove","playerOptions","controls","modestbranding","rel","title","showinfo","fs","WP","wp_debug","isAdmin","$wrapper","$container","bind","on","width","setVideosList","list","onYouTubePlayerAPIReady","initYoutube","event","data","youtubeIds","player","YT","playerVars","addEventListener","handleVideoStateChange","fadeOut","nextVideo","fadeIn","addClass","openVideo","closeVideo","scrollIn","scrollTo","playVideo","videoId","loadVideoById","currentVideo","getVideoData","indexOf","video_id","$filters","$grid","$portraits","initGrid","isotopeGrid","isotope","itemSelector","layoutMode","$imgs","loadVisible","runs","update","setTimeout","$elements","trigger","filter","rect","getBoundingClientRect","top","innerHeight","handleFilterChange","handlePortraitClick","handleArrangeComplete","preventDefault","currentTarget","dataset","youtubeId","getFilteredYoutubeIds","map","val","filterSelector","getFilterSelector","selector","value","center","lat","lng","zoom","styles","elementType","stylers","color","visibility","weight","markers","google","maps","locations","item","Marker","name","position","parseInt","slug","addListener","playPortraitsByLocation","toggleClass","location"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, document, Site, YT, Swiper, WP, google */\n\nSite = {\n  mobileThreshold: 601,\n  scrollToSpeed: 300,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n\n      if ($('#portraits').length) {\n        // Init grid\n        Site.Portraits.init();\n        // Init player\n        Site.Player.init();\n        // Init Map\n        Site.Map.init();\n      }\n\n      if ($('.paypal-form-holder').length) {\n        Site.Paypal.init();\n      }\n\n      if ($('.swiper-container').length) {\n        // Init any galleries\n        Site.Gallery.init();\n      }\n\n      _this.fitHeight();\n\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.fitHeight();\n\n    _this.Player.calcHeight();\n\n  },\n\n  // Give elements with .js-fit-height a min height of\n  // windows height - header height\n  // or\n  fitHeight: function() {\n    var _this = this;\n\n    var $fitElements = $('.js-fit-height');\n\n    // Get window height\n    var windowHeight = $(window).height();\n\n    // Get header height\n    var headerHeight = $('#header .container').height();\n\n    // Calc min height\n    var minHeight = windowHeight - headerHeight;\n\n    // Add min height to each element\n    $fitElements.css({\n      'min-height': minHeight,\n    });\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n};\n\nSite.Gallery = {\n  instances: [],\n  options: {\n    pagination: '.swiper-pagination',\n    loop: true,\n    slidesPerView: 'auto',\n    loopedSlides: 5,\n    spaceBetween: 0,\n    paginationClickable: true,\n    centeredSlides: true,\n    onTap: function(swiper) {\n      swiper.slideNext();\n    },\n  },\n\n  init: function() {\n    var _this = this;\n\n    // Find and loop all swiper containers\n    $('.swiper-container').each(function(index, element) {\n      // Create and save instance on instances array\n      _this.instances[index] = new Swiper(element, _this.options);\n    });\n\n  },\n};\n\nSite.Paypal = {\n  init: function() {\n    var _this = this;\n\n    var $form = $('.paypal-form-holder form');\n\n    $form.each(function() {\n      _this.styleForm($(this));\n    });\n\n    $('.paypal-form-holder').removeClass('u-hidden');\n\n  },\n\n  styleBuy: function($buy) {\n\n  },\n\n  styleForm: function($form) {\n    var $buy = $form.find('input[name=\"submit\"]');\n    var $select = $form.find('select');\n\n    // Style Buy button\n    $buy.attr('type', 'submit');\n    $buy.attr('value', 'Buy');\n    $buy.wrap('<div class=\"grid-item item-s-6\"></div>');\n\n    // Style select\n    if ($select.length) {\n      $form.prepend($select);\n      $form.find('table').remove();\n      $select.wrap('<div class=\"grid-item item-s-6\"></div>');\n    }\n  },\n\n};\n\nSite.Player = {\n  playerOptions: {\n    // https://developers.google.com/youtube/player_parameters?playerVersion=HTML5#Parameters\n    controls: 0,\n    modestbranding: 1,\n    rel: 0,\n    title: 0,\n    showinfo: 0,\n    fs: 0, // Fullscreen\n  },\n\n  init: function() {\n    var _this = this;\n\n    // If WP_DEBUG turn on controls cuz happy Dev :)\n    if(WP.wp_debug == true && WP.isAdmin == true) {\n      _this.playerOptions.controls = 1;\n    }\n\n    // Get the player container element\n    _this.$wrapper = $('#player-container');\n\n    // Get the player container element\n    _this.$container = $('#portraits');\n\n    // Bind stuff\n    _this.bind();\n\n    // Remove loading\n    // TODO: This shouldn't go here, we must dev a feat to check Google Maps and\n    // Yotube loading, and then remove this class\n    $( window ).on( \"load\", function() {\n      $('body').removeClass('loading');\n    });\n\n  },\n\n  calcHeight: function() {\n    var _this = this;\n\n    var windowHeight = $(window).height();\n    var headerHeight = $('#header .container').height();\n\n    var videoHeight = windowHeight - headerHeight;\n\n    _this.$wrapper.find('iframe').css('height', _this.$wrapper.width() * .5625);\n  },\n\n  setVideosList: function(list) {\n    var _this = this;\n\n    if(list) {\n      _this.list = list;\n    }\n\n  },\n\n  bind: function() {\n    var _this = this;\n\n    // Init youtube whuen youtube api is ready\n    // TODO: subscribe to this event with jQuery\n    window.onYouTubePlayerAPIReady = _this.initYoutube.bind(_this);\n\n    // Listen for updatedyoutubelist\n    $(window).on('updatedyoutubelist', function(event, data) {\n      // Update list cache\n      _this.setVideosList(data.youtubeIds);\n    });\n\n  },\n\n  initYoutube: function() {\n    var _this = this;\n\n    // Init youtube player inside #player-container\n    _this.player = new YT.Player('player-iframe', {\n      playerVars: _this.playerOptions,\n    });\n\n    // Calc player height\n    _this.calcHeight();\n\n    $(window).resize(_this.onResize.bind(_this));\n\n    _this.player.addEventListener('onStateChange', _this.handleVideoStateChange.bind(this));\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.calcHeight();\n\n  },\n\n  handleVideoStateChange: function(event) {\n    var _this = this;\n\n    switch(event.data) {\n      case -1: // Unstarted\n        _this.fadeOut();\n        break;\n      case 0: // Ended\n        _this.fadeOut();\n\n        if(_this.list) {\n          _this.nextVideo();\n        }\n        break;\n      case 1: // Playing\n        _this.fadeIn();\n        break;\n      case 3: // Video ended\n        _this.fadeOut();\n        break;\n      // Check if there's list\n    }\n  },\n\n  fadeOut: function() {\n    var _this = this;\n\n    _this.$container.removeClass('show');\n  },\n\n  fadeIn: function() {\n    var _this = this;\n\n    _this.$container.addClass('show');\n  },\n\n  openVideo: function() {\n    var _this = this;\n\n    _this.$container.addClass('video');\n\n  },\n\n  closeVideo: function() {\n    var _this = this;\n\n    _this.$container.removeClass('video');\n\n  },\n\n  scrollIn: function() {\n    var _this = this;\n\n    // Scroll to top\n    $('body').scrollTo(0, Site.scrollToSpeed);\n  },\n\n  playVideo: function(videoId, list) {\n    var _this = this;\n\n    _this.openVideo();\n\n    // Play video\n    _this.player.loadVideoById(videoId);\n\n\n    // If passed, update list\n    if(typeof list !== 'undefined') {\n      _this.setVideosList(list);\n    }\n\n  },\n\n  nextVideo: function() {\n    var _this = this;\n\n    // Get current video ID\n    var currentVideo =  _this.player.getVideoData();\n    currentVideo = _this.list.indexOf(currentVideo.video_id);\n\n    // Check if theres more videos to play\n    if (_this.list.length > currentVideo + 1) {\n\n      // Get next video ID\n      var nextVideo = _this.list[currentVideo + 1];\n\n      // Play next video\n      _this.playVideo(nextVideo);\n    } else {\n      _this.closeVideo();\n    }\n  },\n\n};\n\nSite.Portraits = {\n  init: function() {\n    var _this = this;\n\n    // Get filters form element\n    _this.$form = $('#portraits-filters');\n\n    // Get filters select elements\n    _this.$filters = _this.$form.find('select');\n\n    // Get grid element\n    _this.$grid = $('#portraits-grid');\n\n    // Get portraits\n    _this.$portraits = _this.$grid.find('.portrait');\n\n    // Init grid\n    _this.initGrid();\n\n    // Bind stuff\n    _this.bind();\n\n  },\n\n  initGrid: function() {\n    var _this = this;\n\n    // Set grid with isotope\n    _this.isotopeGrid = _this.$grid.isotope({\n      // options\n      itemSelector: '.grid-item',\n      layoutMode: 'fitRows'\n    });\n\n    // Load visibale images on layout complete aka after filtering\n    _this.isotopeGrid.isotope('on', 'layoutComplete', function () {\n      var $imgs = _this.isotopeGrid.find('img');\n      _this.loadVisible($imgs, 'lazylazy');\n    });\n\n    // Workaround to make it compatible with lazysizes\n    _this.$grid[0].addEventListener('load', (function(){\n      var runs;\n      var update = function(){\n        _this.$grid.isotope('layout');\n        runs = false;\n      };\n      return function(){\n        if(!runs){\n          runs = true;\n          setTimeout(update, 33);\n        }\n      };\n    }()), true);\n\n  },\n\n  loadVisible: function($elements, trigger) {\n    var _this = this;\n\n    // Filter images that inside the viewport and lazyload them\n    $elements.filter(function() {\n      var rect = this.getBoundingClientRect();\n      return rect.top >= 0 && rect.top <= window.innerHeight;\n    }).trigger(trigger);\n\n  },\n\n  bind: function() {\n    var _this = this;\n\n    // Bind select filters change\n    _this.$filters = $('.filter-select').on('change', _this.handleFilterChange.bind(_this));\n\n    // Bind portrait clicks\n    _this.$portraits.on('click', _this.handlePortraitClick.bind(this));\n\n    // Bind arrange complete grid event\n    _this.$grid.on('arrangeComplete',_this.handleArrangeComplete.bind(_this));\n  },\n\n  handlePortraitClick: function(event) {\n    var _this = this;\n\n    event.preventDefault();\n\n    var videoId = event.currentTarget.dataset.youtubeId;\n\n    var list = _this.getFilteredYoutubeIds();\n\n    Site.Player.playVideo(videoId, list);\n    Site.Player.scrollIn();\n\n  },\n\n  // Get a list of youtube ids (filtered in the list)\n  getFilteredYoutubeIds: function() {\n    var _this = this;\n\n    // Get the filtered elements\n    var filteredElements = _this.$grid.isotope('getFilteredItemElements');\n\n    // Get youtubeIds\n    var youtubeIds = filteredElements.map( function(val) {\n      return val.dataset.youtubeId;\n    });\n\n    return youtubeIds;\n  },\n\n  handleArrangeComplete: function(event) {\n    var _this = this;\n\n    var youtubeIds = _this.getFilteredYoutubeIds();\n\n    // Trigger an event with the list of youtube Ids\n    $(window).trigger('updatedyoutubelist', {\n      youtubeIds: youtubeIds,\n    });\n\n  },\n\n  handleFilterChange: function(event) {\n    var _this = this;\n\n    // Get the selector text to be used for filtering\n    var filterSelector = _this.getFilterSelector();\n\n    // Filter using the selector on Isotope\n    _this.$grid.isotope({\n      filter: filterSelector,\n    });\n\n  },\n\n  // Return a string selector based on the filter values\n  // Eg. '[data-filters*=age-20]'\n  //     '[data-filters*=age-20][data-filters*=subject-subject-1]'\n  getFilterSelector: function() {\n    var _this = this;\n\n    var selector = '';\n\n    // Iterate thru the filters to get it's values\n    _this.$filters.each( function(index) {\n      if(this.value) {\n\n        // Build up selector string\n        selector += '[data-filters*=' + this.dataset.filter + '-' + this.value + ']';\n      }\n    });\n\n    return selector;\n  },\n\n};\n\nSite.Map = {\n  options: {\n    // TODO: Set coordinates\n    center: {\n      lat: -34.397,\n      lng: 150.644\n    },\n    zoom: 2,\n    styles: [\n      {\n        \"elementType\": \"geometry.fill\",\n        \"stylers\": [\n          {\n            \"color\": \"#ffffff\"\n          },\n          {\n            \"visibility\": \"on\"\n          }\n        ]\n      },\n      {\n        \"elementType\": \"geometry.stroke\",\n        \"stylers\": [\n          {\n            \"color\": \"#000000\"\n          },\n          {\n            \"visibility\": \"on\"\n          },\n          {\n            \"weight\": 0.5\n          }\n        ]\n      },\n      {\n        \"elementType\": \"labels.text.fill\",\n        \"stylers\": [\n          {\n            \"color\": \"#000000\"\n          }\n        ]\n      },\n      {\n        \"elementType\": \"labels.text.stroke\",\n        \"stylers\": [\n          {\n            \"visibility\": \"off\"\n          }\n        ]\n      }\n    ],\n  },\n  markers: [],\n\n  init: function() {\n    var _this = this;\n\n    // Get grid element\n    // TODO: find a way of not repeating this data here and in Site.Portraits\n    _this.$grid = $('#portraits-grid');\n\n    // Get portraits\n    // TODO: find a way of not repeating this data here and in Site.Portraits\n    _this.$portraits = _this.$grid.find('.portrait');\n\n    // Get shared wrapper\n    _this.$wrapper = $('#map-portraits-wrapper');\n\n    // Get map container\n    _this.$container = $('#map-container');\n\n    // Init google maps\n    _this.map = new google.maps.Map(_this.$container[0], _this.options);\n\n    // Add a marker for each location\n    if (WP.locations.length) {\n      $(WP.locations).each(function(index, item) {\n        // Add marker\n        _this.markers[index] = new google.maps.Marker({\n          map: _this.map,\n          title: item.name,\n          position: {\n            lat: parseInt(item.lat),\n            lng: parseInt(item.lng),\n          }\n        });\n\n        // Add slug to the marker\n        _this.markers[index].slug = item.slug;\n\n        // Add click listener\n        _this.markers[index].addListener('click', function() {\n          _this.playPortraitsByLocation(this.slug);\n        });\n      });\n    }\n\n    _this.bind();\n\n  },\n\n  bind: function() {\n    var _this = this;\n\n    $('.js-toggle-map').on('click', function(event) {\n      event.preventDefault();\n      _this.$wrapper.toggleClass('show-map');\n    });\n  },\n\n  // Play portraits by location\n  playPortraitsByLocation: function(location) {\n    var _this = this;\n\n    // Empty list for youtube IDs\n    var list = [];\n\n    // Filter selector string\n    var filter = '[data-filters*=location-' + location + ']';\n\n    // Filter portraits\n    var $filteredPortraits = _this.$portraits.filter(filter);\n\n    // Save youtube IDs\n    $filteredPortraits.each(function(index, element) {\n      list[index] = element.dataset.youtubeId;\n    });\n\n    // Play first video, update the list\n    Site.Player.playVideo(list[0], list);\n\n    // Scroll to top\n    $('body').scrollTo(0, Site.scrollToSpeed);\n\n  },\n};\n\nSite.init();\n"]}