{"version":3,"sources":["main.js"],"names":["Site","mobileThreshold","scrollToSpeed","init","_this","this","$","window","resize","onResize","document","ready","length","Portraits","Player","Map","Paypal","Gallery","on","toggleClass","fixWidows","each","string","html","replace","debounce","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","instances","options","pagination","loop","slidesPerView","loopedSlides","spaceBetween","paginationClickable","centeredSlides","onTap","swiper","slideNext","index","element","Swiper","styleForm","removeClass","styleBuy","$buy","$form","find","$select","attr","wrap","prepend","remove","playerOptions","controls","modestbranding","rel","title","showinfo","fs","WP","wp_debug","isAdmin","$wrapper","$container","bind","setVideosList","list","onYouTubePlayerAPIReady","initYoutube","event","data","youtubeIds","player","YT","playerVars","addEventListener","handleVideoReady","handleVideoStateChange","checkHash","fadeOut","nextVideo","fadeIn","addClass","openVideo","sizeIframe","closeVideo","scrollIn","scrollTo","playVideo","videoId","loadVideoById","currentVideo","getVideoData","indexOf","video_id","windowWidth","width","windowHeight","height","headerHeight","outerHeight","filterHeight","landscapeIframeHeight","portraitIframeHeight","hasClass","css","$filters","$grid","$portraits","initGrid","shuffle","Shuffle","itemSelector","sizer","filterMode","FilterMode","ALL","runs","update","layout","handleFilterChange","handleHashChange","handleArrangeComplete","hash","location","split","getFilteredYoutubeIds","toArray","map","val","dataset","youtubeId","trigger","filterArray","getFilterArray","filter","value","push","mapTypeControl","fullscreenControl","streetViewControl","zoomControl","center","lat","lng","minZoom","maxZoom","icon","styles","elementType","stylers","color","visibility","weight","dataStyle","fillColor","strokeWeight","markers","geoJSONURL","themeUrl","url","scaledSize","google","maps","Size","anchor","Point","loadGeoJson","setStyle","bounds","LatLngBounds","locations","item","Marker","name","position","parseInt","slug","addListener","playPortraitsByLocation","extend","getPosition","setCenter","getCenter","addListenerOnce","setZoom","getZoom","fitBounds","limitBounds","zoomButtons","centerMapWithinBounds","sLat","getBounds","getSouthWest","nLat","getNorthEast","panTo","debouncedCenter","preventDefault","zoomChange","currentZoom","zoomLevel"],"mappings":"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","file":"main.min.js","sourcesContent":["/* jshint browser: true, devel: true, indent: 2, curly: true, eqeqeq: true, futurehostile: true, latedef: true, undef: true, unused: true */\n/* global $, document, Site, YT, Swiper, WP, google */\n\nSite = {\n  mobileThreshold: 601,\n  scrollToSpeed: 300,\n  init: function() {\n    var _this = this;\n\n    $(window).resize(function(){\n      _this.onResize();\n    });\n\n    $(document).ready(function () {\n\n      if ($('#portraits').length) {\n        // Init grid\n        Site.Portraits.init();\n        // Init player\n        Site.Player.init();\n        // Init Map\n        Site.Map.init();\n      }\n\n      if ($('.paypal-form-holder').length) {\n        Site.Paypal.init();\n      }\n\n      if ($('.swiper-container').length) {\n        // Init any galleries\n        Site.Gallery.init();\n      }\n\n      $('.js-menu-toggle').on('click', function() {\n        $('#mobile-menu').toggleClass('open');\n      });\n\n    });\n\n  },\n\n  onResize: function() {\n    var _this = this;\n\n  },\n\n  fixWidows: function() {\n    // utility class mainly for use on headines to avoid widows [single words on a new line]\n    $('.js-fix-widows').each(function(){\n      var string = $(this).html();\n      string = string.replace(/ ([^ ]*)$/,'&nbsp;$1');\n      $(this).html(string);\n    });\n  },\n\n  // classic debounce https://davidwalsh.name/javascript-debounce-function\n  debounce: function(func, wait, immediate) {\n    var timeout;\n\n    return function() {\n      var context = this, args = arguments;\n      var later = function() {\n        timeout = null;\n        if (!immediate) func.apply(context, args);\n      };\n      var callNow = immediate && !timeout;\n\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) func.apply(context, args);\n    };\n  }\n};\n\nSite.Gallery = {\n  instances: [],\n  options: {\n    pagination: '.swiper-pagination',\n    loop: true,\n    slidesPerView: 'auto',\n    loopedSlides: 5,\n    spaceBetween: 0,\n    paginationClickable: true,\n    centeredSlides: true,\n    onTap: function(swiper) {\n      swiper.slideNext();\n    },\n  },\n\n  init: function() {\n    var _this = this;\n\n    // Find and loop all swiper containers\n    $('.swiper-container').each(function(index, element) {\n      // Create and save instance on instances array\n      _this.instances[index] = new Swiper(element, _this.options);\n    });\n\n  },\n};\n\nSite.Paypal = {\n  init: function() {\n    var _this = this;\n\n    var $form = $('.paypal-form-holder form');\n\n    $form.each(function() {\n      _this.styleForm($(this));\n    });\n\n    $('.paypal-form-holder').removeClass('u-hidden');\n\n  },\n\n  styleBuy: function($buy) {\n\n  },\n\n  styleForm: function($form) {\n    var $buy = $form.find('input[name=\"submit\"]');\n    var $select = $form.find('select');\n\n    // Style Buy button\n    $buy.attr('type', 'submit');\n    $buy.attr('value', 'Buy');\n    $buy.wrap('<div class=\"grid-item item-s-6\"></div>');\n\n    // Style select\n    if ($select.length) {\n      $form.prepend($select);\n      $form.find('table').remove();\n      $select.wrap('<div class=\"grid-item item-s-6\"></div>');\n    }\n  },\n\n};\n\nSite.Player = {\n  playerOptions: {\n    // https://developers.google.com/youtube/player_parameters?playerVersion=HTML5#Parameters\n    controls: 0,\n    modestbranding: 1,\n    rel: 0,\n    title: 0,\n    showinfo: 0,\n    fs: 0, // Fullscreen\n  },\n\n  init: function() {\n    var _this = this;\n\n    // If WP_DEBUG turn on controls cuz happy Dev :)\n    if(WP.wp_debug == true && WP.isAdmin == true) {\n      _this.playerOptions.controls = 1;\n    }\n\n    // Get the player container element\n    _this.$wrapper = $('#player-container');\n\n    // Get the player container element\n    _this.$container = $('#portraits');\n\n    // Bind stuff\n    _this.bind();\n\n    // Remove loading\n    // TODO: This shouldn't go here, we must dev a feat to check Google Maps and\n    // Yotube loading, and then remove this class\n    $( window ).on( \"load\", function() {\n      $('body').removeClass('loading');\n    });\n\n  },\n\n  setVideosList: function(list) {\n    var _this = this;\n\n    if(list) {\n      _this.list = list;\n    }\n\n  },\n\n  bind: function() {\n    var _this = this;\n\n    // Init youtube whuen youtube api is ready\n    // TODO: subscribe to this event with jQuery\n    window.onYouTubePlayerAPIReady = _this.initYoutube.bind(_this);\n\n    // Listen for updatedyoutubelist\n    $(window).on('updatedyoutubelist', function(event, data) {\n      // Update list cache\n      _this.setVideosList(data.youtubeIds);\n    });\n\n  },\n\n  initYoutube: function() {\n    var _this = this;\n\n    // Init youtube player inside #player-container\n    _this.player = new YT.Player('player-iframe', {\n      playerVars: _this.playerOptions,\n    });\n\n    $(window).resize(_this.onResize.bind(_this));\n\n\n    _this.player.addEventListener('onReady', _this.handleVideoReady.bind(this));\n    _this.player.addEventListener('onStateChange', _this.handleVideoStateChange.bind(this));\n\n    $(window).resize(_this.onResize.bind(_this));\n\n  },\n\n  handleVideoReady: function(event) {\n    Site.Portraits.checkHash();\n  },\n\n  handleVideoStateChange: function(event) {\n    var _this = this;\n\n    switch(event.data) {\n      case -1: // Unstarted\n        _this.fadeOut();\n        break;\n      case 0: // Ended\n        _this.fadeOut();\n\n        if(_this.list) {\n          _this.nextVideo();\n        }\n        break;\n      case 1: // Playing\n        _this.fadeIn();\n        break;\n      case 3: // Video ended\n        _this.fadeOut();\n        break;\n      // Check if there's list\n    }\n  },\n\n  fadeOut: function() {\n    var _this = this;\n\n    _this.$container.removeClass('show');\n  },\n\n  fadeIn: function() {\n    var _this = this;\n\n    _this.$container.addClass('show');\n  },\n\n  openVideo: function() {\n    var _this = this;\n\n    _this.$container.addClass('video');\n\n    _this.sizeIframe();\n  },\n\n  closeVideo: function() {\n    var _this = this;\n\n    _this.$container.removeClass('video');\n\n  },\n\n  scrollIn: function() {\n    var _this = this;\n\n    // Scroll to top\n    $('body').scrollTo(0, Site.scrollToSpeed);\n  },\n\n  playVideo: function(videoId, list) {\n    var _this = this;\n\n    _this.openVideo();\n\n    // Play video\n    _this.player.loadVideoById(videoId);\n\n\n    // If passed, update list\n    if(typeof list !== 'undefined') {\n      _this.setVideosList(list);\n    }\n\n  },\n\n  nextVideo: function() {\n    var _this = this;\n\n    // Get current video ID\n    var currentVideo =  _this.player.getVideoData();\n    currentVideo = _this.list.indexOf(currentVideo.video_id);\n\n    // Check if theres more videos to play\n    if (_this.list.length > currentVideo + 1) {\n\n      // Get next video ID\n      var nextVideo = _this.list[currentVideo + 1];\n\n      // Play next video\n      _this.playVideo(nextVideo);\n    } else {\n      _this.closeVideo();\n    }\n  },\n\n  sizeIframe: function() {\n    var _this = this;\n\n    var windowWidth = $(window).width();\n    var windowHeight = $(window).height();\n    var headerHeight = $('#header').outerHeight();\n    var filterHeight = $('#portraits-filters-container').outerHeight();\n\n    var landscapeIframeHeight = windowHeight - (headerHeight + filterHeight);\n    var portraitIframeHeight = (windowWidth / 16) * 9;\n\n    if (_this.$container.hasClass('video')) {\n      if (windowWidth <= (windowHeight / 9 * 16) && portraitIframeHeight <= landscapeIframeHeight) {\n        // Portrait\n\n        $('#player-wrapper').css({\n          'height': portraitIframeHeight\n        });\n\n        $('#player-iframe').css({\n          'width': '100%'\n        });\n\n      } else {\n        // Landscape\n\n        $('#player-wrapper').css({\n          'height': landscapeIframeHeight\n        });\n\n        $('#player-iframe').css({\n          'width': (landscapeIframeHeight / 9) * 16\n        });\n      }\n    }\n  },\n\n  onResize: function() {\n    var _this = this;\n\n    _this.sizeIframe();\n  },\n\n};\n\nSite.Portraits = {\n  init: function() {\n    var _this = this;\n\n    // Get filters form element\n    _this.$form = $('#portraits-filters');\n\n    // Get filters select elements\n    _this.$filters = _this.$form.find('select');\n\n    // Get grid element\n    _this.$grid = $('#portraits-grid');\n\n    // Get portraits\n    _this.$portraits = _this.$grid.find('.portrait');\n\n    // Init grid\n    _this.initGrid();\n\n    // Bind stuff\n    _this.bind();\n\n  },\n\n  initGrid: function() {\n    var _this = this;\n\n    _this.$grid.shuffle = new window.Shuffle(_this.$grid, {\n      itemSelector: '.portrait',\n      sizer: '#portrait-sizer',\n      filterMode: window.Shuffle.FilterMode.ALL,\n    });\n\n    // Workaround to make it compatible with lazysizes\n    _this.$grid[0].addEventListener('load', (function(){\n      var runs;\n      var update = function(){\n        _this.$grid.shuffle.layout();\n        runs = false;\n      };\n      return function(){\n        if(!runs){\n          runs = true;\n          setTimeout(update, 33);\n        }\n      };\n    }()), true);\n  },\n\n  bind: function() {\n    var _this = this;\n\n    // Bind select filters change\n    _this.$filters = $('.filter-select').on('change', _this.handleFilterChange.bind(_this));\n\n    // Bind hash change aka clicking on a portrait\n    $(window).on('hashchange', _this.handleHashChange.bind(_this));\n\n    // Bind arrange complete grid event\n    _this.$grid.on('arrangeComplete',_this.handleArrangeComplete.bind(_this));\n  },\n\n  checkHash: function() {\n    var _this = this;\n\n    // Get hash\n    var hash = location.hash.split('/');\n\n    // Check that its a portrait\n    if(hash[1] === 'portrait') {\n\n      // Get youtube ID\n      var videoId = hash[hash.length - 1];\n\n      var list = _this.getFilteredYoutubeIds();\n\n      Site.Player.playVideo(videoId, list);\n\n      Site.Player.scrollIn();\n    }\n  },\n\n  handleHashChange: function(event) {\n    var _this = this;\n\n    _this.checkHash();\n\n  },\n\n  // Get a list of youtube ids (filtered in the list)\n  getFilteredYoutubeIds: function() {\n    var _this = this;\n\n    // Get the filtered elements\n    var filteredElements = $('.shuffle-item--visible').toArray();\n\n    // Get youtubeIds\n    var youtubeIds = filteredElements.map( function(val) {\n      return val.dataset.youtubeId;\n    });\n\n    return youtubeIds;\n  },\n\n  handleArrangeComplete: function(event) {\n    var _this = this;\n\n    var youtubeIds = _this.getFilteredYoutubeIds();\n\n    // Trigger an event with the list of youtube Ids\n    $(window).trigger('updatedyoutubelist', {\n      youtubeIds: youtubeIds,\n    });\n\n  },\n\n  handleFilterChange: function(event) {\n    var _this = this;\n\n    // Get the selector text to be used for filtering\n    var filterArray = _this.getFilterArray();\n\n    _this.$grid.shuffle.filter(filterArray);\n  },\n\n  // Return an array of filters\n  // Eg. [\"subject-ants\"]\n  //     [\"subject-ants\", \"location-pants\"]\n  getFilterArray: function() {\n    var _this = this;\n\n    var filterArray = [];\n\n    // Iterate thru the filters to get it's values\n    _this.$filters.each( function(index) {\n      if(this.value) {\n\n        // Build up selector string\n        filterArray.push(this.dataset.filter + '-' + this.value);\n      }\n    });\n\n    return filterArray;\n  },\n\n};\n\nSite.Map = {\n  options: {\n    mapTypeControl: false,\n    fullscreenControl: false,\n    streetViewControl: false,\n    zoomControl: false,\n    // TODO: Set coordinates\n    center: {\n      lat: -34.397,\n      lng: 150.644\n    },\n    minZoom: 2,\n    maxZoom: 15,\n    icon: {\n      // requires Maps API and set on init()\n    },\n    styles: [\n      {\n        \"elementType\": \"geometry.fill\",\n        \"stylers\": [\n          {\n            \"color\": \"#ffffff\"\n          },\n          {\n            \"visibility\": \"on\"\n          }\n        ]\n      },\n      {\n        \"elementType\": \"geometry.stroke\",\n        \"stylers\": [\n          {\n            \"color\": \"#000000\"\n          },\n          {\n            \"visibility\": \"on\"\n          },\n          {\n            \"weight\": 0.5\n          }\n        ]\n      },\n      {\n        \"elementType\": \"labels.text.fill\",\n        \"stylers\": [\n          {\n            \"color\": \"#000000\"\n          }\n        ]\n      },\n      {\n        \"elementType\": \"labels.text.stroke\",\n        \"stylers\": [\n          {\n            \"visibility\": \"off\"\n          }\n        ]\n      }\n    ],\n  },\n  dataStyle: {\n    fillColor: 'white',\n    strokeWeight: 1\n  },\n  markers: [],\n  geoJSONURL: WP.themeUrl + '/dist/static/countries.geo.json',\n\n  init: function() {\n    var _this = this;\n\n    // Setup options that depend on Maps API library\n    _this.options.icon = {\n      url: WP.themeUrl + '/dist/img/truth-bubble.png',\n      scaledSize: new google.maps.Size(75.5,55),\n      anchor: new google.maps.Point(0,55)\n    };\n\n    // Get grid element\n    // TODO: find a way of not repeating this data here and in Site.Portraits\n    _this.$grid = $('#portraits-grid');\n\n    // Get portraits\n    // TODO: find a way of not repeating this data here and in Site.Portraits\n    _this.$portraits = _this.$grid.find('.portrait');\n\n    // Get shared wrapper\n    _this.$wrapper = $('#map-portraits-wrapper');\n\n    // Get map container\n    _this.$container = $('#map-container');\n\n    // Init google maps\n    _this.map = new google.maps.Map(_this.$container[0], _this.options);\n\n    // Load GeoJSON with countries' borders\n    _this.map.data.loadGeoJson(_this.geoJSONURL);\n\n    // Set the stroke width, and fill color for each polygon\n    _this.map.data.setStyle(_this.dataStyle);\n\n    // Init a bounds object\n    var bounds = new google.maps.LatLngBounds();\n\n    // Add a marker for each location\n    if (WP.locations.length) {\n      $(WP.locations).each(function(index, item) {\n\n        // Add marker\n        _this.markers[index] = new google.maps.Marker({\n          map: _this.map,\n          title: item.name,\n          icon: _this.options.icon,\n          position: {\n            lat: parseInt(item.lat),\n            lng: parseInt(item.lng),\n          }\n        });\n\n        if(WP.wp_debug == true && WP.isAdmin == true) {\n          // Add marker\n          _this.markers[index] = new google.maps.Marker({\n            map: _this.map,\n            title: item.name,\n            position: {\n              lat: parseInt(item.lat),\n              lng: parseInt(item.lng),\n            }\n          });\n        }\n\n        // Add slug to the marker\n        _this.markers[index].slug = item.slug;\n\n        // Add click listener\n        _this.markers[index].addListener('click', function() {\n          _this.playPortraitsByLocation(this.slug);\n        });\n\n        // Add item location to the bounds list\n        bounds.extend(_this.markers[index].getPosition());\n\n      });\n\n      // Make map fit all locations\n\n      //center the map to the geometric center of all markers\n      _this.map.setCenter(bounds.getCenter());\n\n      // Listen for bounds change (only once)\n      google.maps.event.addListenerOnce(_this.map, 'bounds_changed', function(event) {\n        //remove one zoom level to ensure no marker is on the edge.\n        _this.map.setZoom(_this.map.getZoom()-1);\n\n        // set a minimum zoom\n        // if you got only 1 marker or all markers are too close to each other map will be zoomed too much.\n        if (_this.map.getZoom() > 13) {\n          _this.map.setZoom(4);\n        }\n\n      }.bind(this));\n\n      _this.map.fitBounds(bounds);\n\n    }\n\n    _this.bind();\n\n    _this.limitBounds();\n\n    _this.zoomButtons();\n  },\n\n  // prevent map dragging into North/South grey areas\n  limitBounds: function() {\n    var _this = this;\n\n    function centerMapWithinBounds() {\n      var sLat = _this.map.getBounds().getSouthWest().lat();\n      var nLat = _this.map.getBounds().getNorthEast().lat();\n\n      if (sLat < -89 || nLat > 89) {\n        // map out of bounds\n        // zoom out and pan to center of map\n        _this.map.setZoom(_this.options.minZoom);\n        _this.map.panTo({lat: 0, lng: 0});\n      }\n    };\n\n    var debouncedCenter = Site.debounce(function() {\n      centerMapWithinBounds();\n    }, 25);\n\n    google.maps.event.addListener(_this.map, 'drag', debouncedCenter);\n\n  },\n\n  bind: function() {\n    var _this = this;\n\n    $('.toggle-map').on('click', function(event) {\n      event.preventDefault();\n      // Toggle map class\n      _this.$wrapper.toggleClass('show-map');\n\n      // Scroll to where portraits or map is\n      $('body').scrollTo(_this.$wrapper, Site.scrollToSpeed);\n    });\n  },\n\n  // Play portraits by location\n  playPortraitsByLocation: function(location) {\n    var _this = this;\n\n    // Empty list for youtube IDs\n    var list = [];\n\n    // Filter selector string\n    var filter = '[data-groups*=\"location-' + location + '\"]';\n\n    // Filter portraits\n    var $filteredPortraits = _this.$portraits.filter(filter);\n\n    // Save youtube IDs\n    $filteredPortraits.each(function(index, element) {\n      list[index] = element.dataset.youtubeId;\n    });\n\n    // Play first video, update the list\n    Site.Player.playVideo(list[0], list);\n\n    // Scroll to top\n    $('body').scrollTo(0, Site.scrollToSpeed);\n\n  },\n\n  zoomButtons: function() {\n    var _this = this;\n\n    $('.map-zoom-button').on('click', function() {\n      var zoomChange = parseInt($(this).attr('data-zoom'));\n      var currentZoom = _this.map.getZoom();\n\n      _this.map.setZoom(currentZoom + zoomChange);\n    });\n\n    google.maps.event.addListener(_this.map, 'zoom_changed', function(){\n      var zoomLevel = _this.map.getZoom();\n\n      if (zoomLevel <= _this.options.minZoom) {\n        $('.map-zoom-button[data-zoom=\"-1\"]').addClass('disabled');\n      } else {\n        $('.map-zoom-button[data-zoom=\"-1\"]').removeClass('disabled');\n      }\n\n      if (zoomLevel >= _this.options.maxZoom) {\n        $('.map-zoom-button[data-zoom=\"1\"]').addClass('disabled');\n      } else {\n        $('.map-zoom-button[data-zoom=\"1\"]').removeClass('disabled');\n      }\n    });\n  },\n};\n\nSite.init();\n"]}